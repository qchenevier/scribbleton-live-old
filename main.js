!function(e){function n(n){for(var i,a,s=n[0],u=n[1],l=n[2],f=0,p=[];f<s.length;f++)a=s[f],Object.prototype.hasOwnProperty.call(r,a)&&r[a]&&p.push(r[a][0]),r[a]=0;for(i in u)Object.prototype.hasOwnProperty.call(u,i)&&(e[i]=u[i]);for(c&&c(n);p.length;)p.shift()();return o.push.apply(o,l||[]),t()}function t(){for(var e,n=0;n<o.length;n++){for(var t=o[n],i=!0,s=1;s<t.length;s++){var u=t[s];0!==r[u]&&(i=!1)}i&&(o.splice(n--,1),e=a(a.s=t[0]))}return e}var i={},r={0:0},o=[];function a(n){if(i[n])return i[n].exports;var t=i[n]={i:n,l:!1,exports:{}};return e[n].call(t.exports,t,t.exports,a),t.l=!0,t.exports}a.m=e,a.c=i,a.d=function(e,n,t){a.o(e,n)||Object.defineProperty(e,n,{enumerable:!0,get:t})},a.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},a.t=function(e,n){if(1&n&&(e=a(e)),8&n)return e;if(4&n&&"object"==typeof e&&e&&e.__esModule)return e;var t=Object.create(null);if(a.r(t),Object.defineProperty(t,"default",{enumerable:!0,value:e}),2&n&&"string"!=typeof e)for(var i in e)a.d(t,i,function(n){return e[n]}.bind(null,i));return t},a.n=function(e){var n=e&&e.__esModule?function(){return e.default}:function(){return e};return a.d(n,"a",n),n},a.o=function(e,n){return Object.prototype.hasOwnProperty.call(e,n)},a.p="";var s=window.webpackJsonp=window.webpackJsonp||[],u=s.push.bind(s);s.push=n,s=s.slice();for(var l=0;l<s.length;l++)n(s[l]);var c=u;o.push([37,1]),t()}([,,,,,,,function(e,n,t){var i=t(20);"string"==typeof i&&(i=[[e.i,i,""]]),i.locals&&(e.exports=i.locals);(0,t(6).default)("77f9fee7",i,!1,{})},function(e,n,t){var i=t(29);"string"==typeof i&&(i=[[e.i,i,""]]),i.locals&&(e.exports=i.locals);(0,t(6).default)("4cd6b2c9",i,!1,{})},function(e,n,t){var i=t(31);"string"==typeof i&&(i=[[e.i,i,""]]),i.locals&&(e.exports=i.locals);(0,t(6).default)("5b2eb30a",i,!1,{})},function(e,n,t){var i=t(34);"string"==typeof i&&(i=[[e.i,i,""]]),i.locals&&(e.exports=i.locals);(0,t(6).default)("03ada772",i,!1,{})},,,,,,,,,function(e,n,t){"use strict";var i=t(7);t.n(i).a},function(e,n,t){(n=t(5)(!1)).push([e.i,"\n.play {\n  color: green;\n}\n.pause {\n  color: grey;\n}\n",""]),e.exports=n},,,,,,,,function(e,n,t){"use strict";var i=t(8);t.n(i).a},function(e,n,t){(n=t(5)(!1)).push([e.i,"\n[data-v-64cc84e8] .CodeMirror {\n  font-size: 12;\n  height: var(--height);\n  direction: ltr;\n  background: var(--background);\n  font-family: Consolas, Menlo, Monaco, Lucida Console, Liberation Mono,\n    DejaVu Sans Mono, Bitstream Vera Sans Mono, Courier New, monospace, serif;\n}\n",""]),e.exports=n},function(e,n,t){"use strict";var i=t(9);t.n(i).a},function(e,n,t){(n=t(5)(!1)).push([e.i,"\n.column[data-v-74eb68cc] {\n  float: left;\n  width: 355;\n}\n",""]),e.exports=n},,function(e,n,t){"use strict";var i=t(10);t.n(i).a},function(e,n,t){(n=t(5)(!1)).push([e.i,'\n#app {\n  font-family: "Roboto", sans-serif;\n}\n.column {\n  float: left;\n  width: 355;\n}\n',""]),e.exports=n},,,function(e,n,t){"use strict";t.r(n);var i=t(18),r=function(){var e=this,n=e.$createElement,t=e._self._c||n;return t("div",{attrs:{id:"app"}},[t("div",[t("h1",[e._v("Scribbletune playground")]),e._v(" "),t("SaveLoadJson",{model:{value:e.channelsArray,callback:function(n){e.channelsArray=n},expression:"channelsArray"}}),e._v(" "),t("Oscilloscope"),e._v(" "),t("PlayPauseButton",{model:{value:e.isPlaying,callback:function(n){e.isPlaying=n},expression:"isPlaying"}}),e._v(" "),t("button",{on:{click:function(){return e.addChannel()}}},[e._v("\n      Add channel\n    ")])],1),e._v(" "),e._l(e.channels,(function(n,i){return t("div",[t("Channel",{key:"channel-"+i,on:{close:e.removeChannel},model:{value:e.channels[i],callback:function(n){e.$set(e.channels,i,n)},expression:"channels[id]"}})],1)}))],2)};r._withStripped=!0;var o=function(){var e=this.$createElement;return(this._self._c||e)("button",{class:this.value?"pause":"play",on:{click:this.toggle}},[this._v("\n  "+this._s(this.value?"Pause":"Play")+"\n")])};o._withStripped=!0;var a={props:{value:{default:!1}},methods:{toggle:function(){this.$emit("input",!this.value)}}},s=(t(19),t(3)),u=Object(s.a)(a,o,[],!1,null,null,null);u.options.__file="src/PlayPauseButton.vue";var l=u.exports,c=function(){var e=this,n=e.$createElement,t=e._self._c||n;return t("div",{staticClass:"column"},[t("button",{on:{click:function(n){return e.$emit("close",e.id)}}},[e._v("Close")]),e._v(" "),t("button",{on:{click:function(){return e.addEffect()}}},[e._v("Add effect")]),e._v(" "),t("input",{directives:[{name:"model",rawName:"v-model",value:e.input.offlineRendering,expression:"input.offlineRendering"}],attrs:{type:"checkbox",id:"checkbox"},domProps:{checked:Array.isArray(e.input.offlineRendering)?e._i(e.input.offlineRendering,null)>-1:e.input.offlineRendering},on:{change:function(n){var t=e.input.offlineRendering,i=n.target,r=!!i.checked;if(Array.isArray(t)){var o=e._i(t,null);i.checked?o<0&&e.$set(e.input,"offlineRendering",t.concat([null])):o>-1&&e.$set(e.input,"offlineRendering",t.slice(0,o).concat(t.slice(o+1)))}else e.$set(e.input,"offlineRendering",r)}}}),e._v(" "),t("label",{attrs:{for:"checkbox"}},[e._v("Pre-render: "+e._s(e.input.offlineRendering))]),e._v(" "),t("Clip",{key:"clip-"+e.id,model:{value:e.input.clips,callback:function(n){e.$set(e.input,"clips",n)},expression:"input.clips"}}),e._v(" "),t("Instrument",{key:"instrument-"+e.id,attrs:{names:e.instrumentNames},model:{value:e.input.instrument,callback:function(n){e.$set(e.input,"instrument",n)},expression:"input.instrument"}}),e._v(" "),e._l(e.input.effects,(function(n,i){return t("Instrument",{key:"effect-"+i,attrs:{names:e.effectNames,closeButton:!0,height:"100px"},on:{close:e.removeEffect},model:{value:e.input.effects[i],callback:function(n){e.$set(e.input.effects,i,n)},expression:"input.effects[idEffect]"}})}))],2)};c._withStripped=!0;var f=function(){var e=this,n=e.$createElement,t=e._self._c||n;return t("div",[t("select",{directives:[{name:"model",rawName:"v-model",value:e.input.name,expression:"input.name"}],on:{change:function(n){var t=Array.prototype.filter.call(n.target.options,(function(e){return e.selected})).map((function(e){return"_value"in e?e._value:e.value}));e.$set(e.input,"name",n.target.multiple?t:t[0])}}},e._l(e.names,(function(n){return t("option",{domProps:{value:n}},[e._v(e._s(n)+" ")])})),0),e._v(" "),e.closeButton?t("button",{on:{click:function(n){return e.$emit("close",e.id)}}},[e._v("Close")]):e._e(),e._v(" "),t("ParamsEditor",{key:"instrument-editor-"+e.id,attrs:{height:e.height},model:{value:e.input.params,callback:function(n){e.$set(e.input,"params",n)},expression:"input.params"}})],1)};f._withStripped=!0;var p=function(){var e=this,n=e.$createElement,t=e._self._c||n;return t("div",[t("codemirror",{key:"editor-"+e.id,ref:"editor-"+e.id,style:{height:e.height,background:e.background},attrs:{options:e.editorOptions},on:{focus:function(n){e.background="#FFFFFF"},blur:function(n){e.$emit("input",e.YAML.parse(e.input)),e.background="#F7F7F7"}},model:{value:e.input,callback:function(n){e.input=n},expression:"input"}})],1)};p._withStripped=!0;var d=t(15),h=(t(21),t(23),t(11)),v=t.n(h),m={components:{codemirror:d.codemirror},props:{value:{},editorOptions:{default:function(){return{tabSize:2,mode:"text/yaml",dragDrop:!1,line:!0}}},height:{default:"300px"}},data:function(){return{YAML:v.a,input:v.a.stringify(this.value),background:"#F7F7F7"}},computed:{id:function(){return this.$vnode.key.split("-")[1]}},watch:{value:function(){this.input=v.a.stringify(this.value)}}},g=(t(28),Object(s.a)(m,p,[],!1,null,"64cc84e8",null));g.options.__file="src/ParamsEditor.vue";var y=g.exports,b={components:{ParamsEditor:y},props:{value:void 0,names:void 0,height:{default:"300px"},closeButton:{default:!1}},data:function(){return{input:this.value}},computed:{id:function(){return this.$vnode.key.split("-")[1]},cssParams:function(){return{fontSize:"12px",height:this.height,border:"1px solid #eee"}}},created:function(){this.input||(this.input={name:this.names[0],params:(new Tone[this.names[0]]).get()})},mounted:function(){this.$emit("input",this.input)},watch:{"input.name":{handler:function(){this.input.params=(new Tone[this.input.name]).get()}},input:{deep:!0,handler:function(){this.$emit("input",this.input)}}}},_=Object(s.a)(b,f,[],!1,null,"a0a9ddc0",null);_.options.__file="src/Instrument.vue";var P=_.exports,S=function(){var e=this,n=e.$createElement;return(e._self._c||n)("ParamsEditor",{key:"clips-"+e.id,attrs:{value:e.value,height:"100px"},on:{input:function(n){return e.$emit("input",n)}}})};S._withStripped=!0;var x={components:{ParamsEditor:y},props:{value:{default:function(){return[{notes:"CfatM-1 Cfat-1 CfatM-1",pattern:"x___x__x"}]}}},computed:{id:function(){return this.$vnode.key.split("-")[1]}},mounted:function(){this.$emit("input",this.value)}},w=Object(s.a)(x,S,[],!1,null,"772fe0c9",null);w.options.__file="src/Clip.vue";var k={components:{Instrument:P,Clip:w.exports},props:{value:{default:function(){return{clips:void 0,instrument:void 0,effects:{},offlineRendering:!1}}}},data:function(){return{input:this.value,instrumentNames:["AMSynth","DuoSynth","FMSynth","MembraneSynth","MetalSynth","MonoSynth","NoiseSynth","PluckSynth","Sampler","Synth"],effectNames:["AutoFilter","AutoPanner","AutoWah","BitCrusher","Chebyshev","Chorus","Distortion","FeedbackDelay","Freeverb","FrequencyShifter","JCReverb","Phaser","PingPongDelay","PitchShift","Reverb","StereoWidener","Tremolo","Vibrato"]}},computed:{id:function(){return this.$vnode.key.split("-")[1]}},methods:{addEffect:function(e){var n=Math.floor(16777215*Math.random()).toString(16).padStart(6,"0");this.$set(this.input.effects,n,e)},removeEffect:function(e){this.$delete(this.input.effects,e)}},watch:{input:{deep:!0,handler:function(){this.$emit("input",this.input)}}}},O=(t(30),Object(s.a)(k,c,[],!1,null,"74eb68cc",null));O.options.__file="src/Channel.vue";var j=O.exports,E=t(12),$=function(){var e=this.$createElement;return(this._self._c||e)("VueP5",{on:{setup:this.setup,draw:this.draw}})};$._withStripped=!0;var C=t(16),T={components:{VueP5:t.n(C).a},data:function(){return{mic:void 0,analyzer:void 0,fft:void 0,meter:void 0}},methods:{setup:function(e){e.createCanvas(350,50),e.frameRate(20),this.analyzer=new Tone.Waveform(2048),this.fft=new Tone.FFT(1024),Tone.Destination.connect(this.analyzer),Tone.Destination.connect(this.fft),e.noFill()},draw:function(e){e.background(255);var n=this.analyzer.getValue(),t=this.fft.getValue();e.noStroke(),e.fill("rgba(0, 100, 255, 0.3)"),e.beginShape(),e.vertex(0,50);for(var i=0;i<t.length;i++)e.vertex(e.map(e.log(i),0,e.log(t.length),0,350),e.map(t[i],-127,0,50,0));e.vertex(350,50),e.endShape(),e.noFill(),e.stroke("rgba(0, 100, 255, 0.7)"),e.strokeWeight(1.5),e.beginShape();for(var r=0,o=0,a=0;a<n.length;a++)n[a]>0&&n[a-1]<=0&&0==r&&(r=1,o=a),1==r&&e.vertex(e.map(a-o,0,n.length,0,455),e.map(n[a],-1,1,50,0));if(0==r)for(a=0;a<n.length;a++)e.vertex(e.map(a,0,n.length,0,455),e.map(n[a],-1,1,50,0));e.endShape()}}},F=Object(s.a)(T,$,[],!1,null,null,null);F.options.__file="src/Oscilloscope.vue";var R=F.exports,A=function(){var e=this.$createElement,n=this._self._c||e;return n("div",[n("input",{attrs:{type:"file",id:"file",multiple:""},on:{change:this.loadJson}}),this._v(" "),n("button",{on:{click:this.saveJson}},[this._v("\n    Save JSON\n  ")])])};A._withStripped=!0;var M=t(17),I={props:["value"],methods:{saveJson:function(){var e=JSON.stringify(this.value,null,2),n=new Blob([e],{type:"text/plain;charset=utf-8"});Object(M.saveAs)(n,"scribbletune-playground-save.json")},loadJson:function(e){var n=this,t=new FileReader;t.onload=function(e){var t=JSON.parse(e.target.result);n.$emit("input",t)};for(var i=e.target.files,r=0;r<i.length;r++)t.readAsText(i[r])}}},J=Object(s.a)(I,A,[],!1,null,null,null);J.options.__file="src/SaveLoadJson.vue";var N=J.exports;function B(e,n){return function(e){if(Array.isArray(e))return e}(e)||function(e,n){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var t=[],i=!0,r=!1,o=void 0;try{for(var a,s=e[Symbol.iterator]();!(i=(a=s.next()).done)&&(t.push(a.value),!n||t.length!==n);i=!0);}catch(e){r=!0,o=e}finally{try{i||null==s.return||s.return()}finally{if(r)throw o}}return t}(e,n)||function(e,n){if(!e)return;if("string"==typeof e)return D(e,n);var t=Object.prototype.toString.call(e).slice(8,-1);"Object"===t&&e.constructor&&(t=e.constructor.name);if("Map"===t||"Set"===t)return Array.from(e);if("Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return D(e,n)}(e,n)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function D(e,n){(null==n||n>e.length)&&(n=e.length);for(var t=0,i=new Array(n);t<n;t++)i[t]=e[t];return i}E.addChord(["1P","5P","8P","12P","15P","19P"],[],"fat"),E.addChord(["1P","5P","8P","12P","15P","17M","19P"],[],"fatM");var z={components:{PlayPauseButton:l,Channel:j,Oscilloscope:R,SaveLoadJson:N},data:function(){return{channels:{},toneInstruments:{},toneEffects:{},session:void 0,isPlaying:!1}},computed:{channelsArray:{get:function(){return Object.values(this.channels)},set:function(e){e.map(this.addChannel)}},watchPropsForSessionRebuild:function(){return Object.values(this.channels).filter((function(e){return e})).map((function(e){var n,t;return{instrumentName:null==e||null===(n=e.instrument)||void 0===n?void 0:n.name,effectNames:(null==e?void 0:e.effects)?Object.values(e.effects).map((function(e){return null==e?void 0:e.name})):void 0,clips:null==e?void 0:e.clips,offlineRendering:null==e?void 0:e.offlineRendering,instrumentParams:(null==e?void 0:e.offlineRendering)?null==e||null===(t=e.instrument)||void 0===t?void 0:t.params:void 0,effectParams:(null==e?void 0:e.offlineRendering)&&(null==e?void 0:e.effects)?Object.values(e.effects).map((function(e){return null==e?void 0:e.params})):void 0}}))},watchInstrumentParamsForUpdate:function(){return Object.values(this.channels).map((function(e){var n;return(null==e?void 0:e.offlineRendering)||null==e||null===(n=e.instrument)||void 0===n?void 0:n.params}))},watchEffectParamsForUpdate:function(){return Object.values(this.channels).map((function(e){return!(null==e?void 0:e.offlineRendering)&&(null==e?void 0:e.effects)?void 0:(null==e?void 0:e.effects)?Object.values(e.effects).map((function(e){return null==e?void 0:e.params})):void 0}))}},methods:{tonePlayPause:function(){this.isPlaying?Tone.Transport.start():Tone.Transport.stop()},addChannel:function(e){var n=Math.floor(16777215*Math.random()).toString(16).padStart(6,"0");this.$set(this.channels,n,e)},removeChannel:function(e){this.$delete(this.channels,e)},createToneEffects:function(e,n){var t=this;function i(e,n){return this.toneEffects[n]=new Tone[e],this.toneEffects[n]}return(null==n?void 0:n.effects)?Object.entries(n.effects).map((function(n){var r=B(n,2),o=r[0],a=r[1];return a?i.bind(t)(a.name,"".concat(e,"-").concat(o)):void 0})).filter((function(e){return e})):void 0},createChannel:function(e){var n,t=B(e,2),i=t[0],r=t[1];if((null==r||null===(n=r.instrument)||void 0===n?void 0:n.name)&&(null==r?void 0:r.clips)){this.toneInstruments[i]=new Tone.PolySynth(Tone[r.instrument.name]),this.updateToneInstrumentsParams();var o=this.createToneEffects(i,r);this.updateToneEffectsParams();var a={idx:i,instrument:this.toneInstruments[i],clips:r.clips,offlineRendering:r.offlineRendering,effects:o||[]};this.session.createChannel(a)}},createSession:function(){this.isPlaying=!1,this.tonePlayPause(),Tone.Transport.cancel(),this.session=new E.Session,this.toneInstruments={},this.toneEffects={},Object.entries(this.channels).forEach(this.createChannel);this.session.startRow(0)},updateToneInstrumentsParams:function(){var e=this;Object.entries(this.channels).forEach((function(n){var t,i=B(n,2),r=i[0],o=i[1];(null==o||null===(t=o.instrument)||void 0===t?void 0:t.params)&&e.toneInstruments[r]&&e.toneInstruments[r].set(o.instrument.params)}))},updateToneEffectsParams:function(){var e=this;Object.entries(this.channels).forEach((function(n){var t=B(n,2),i=t[0],r=t[1];r&&Object.entries(r.effects).forEach((function(n){var t=B(n,2),r=t[0],o=t[1],a="".concat(i,"-").concat(r);(null==o?void 0:o.params)&&e.toneEffects[a]&&e.toneEffects[a].set(o.params)}))}))}},watch:{watchPropsForSessionRebuild:{deep:!0,handler:function(){this.createSession()}},watchInstrumentParamsForUpdate:{deep:!0,handler:function(){this.updateToneInstrumentsParams()}},watchEffectParamsForUpdate:{deep:!0,handler:function(){this.updateToneEffectsParams()}},isPlaying:{handler:function(){this.tonePlayPause()}}}},L=(t(33),Object(s.a)(z,r,[],!1,null,null,null));L.options.__file="src/App.vue";var V=L.exports;new i.a({el:"#app",render:function(e){return e(V)}})}]);